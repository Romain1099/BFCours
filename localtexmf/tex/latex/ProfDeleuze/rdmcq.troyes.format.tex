%%%%    Troyes

\definecolor{TroyesColback}{HTML}{4A85A1}% bleu


\newQuestionFormat{Troyes}{% boîte externe
opacityback=1,
colback=TroyesColback!60,
        interior code={%
            \fill[tcbcolback] (interior.north west) rectangle ([xshift=-0.75pt]segmentation.south);
            \fill[tcbcolback] ([xshift=0.75pt]segmentation.south) rectangle (interior.north east);
            }%
}%
{%    boîte interne
sidebyside, boxsep=3pt,
sidebyside gap=7.5pt,%  3+1.5+3
lefthand width=2em,
sidebyside align=top seam, halign upper=center, halign lower=justify,
before upper={\tikz[baseline=(x.base), inner sep=1pt, outer sep=0pt] \node[circle, fill=white, text=black, font=\sffamily\bfseries\tiny, minimum width=1.2em] (x) {\rdmcqQuestioncount};
\tcblower}
}

\newAnswerFormat{Troyes}{horizontal}%
        {%  Zone Réponse
        }%
        [%  Mode correction
            fontupper=\bfseries\boldmath, coltext=white,
            underlay={\fill[red, opacity=0.3, rounded corners=4pt] ([shift={(2.5pt,2.5pt)}]interior.south west) rectangle ([shift={(-2.5pt,-2.5pt)}]interior.north east) ;}
        ]%
        {%  Boîtes internes
        enhanced jigsaw,
        frame engine=empty,
        boxsep=3pt,
        valign=center, halign=center,
        colback=TroyesColback!60
        }

\newAnswerFormat{Troyes}{vertical}
        {%  Zone Réponse
            enhanced jigsaw,
            frame engine=empty,
            colback=TroyesColback!60
        }%
        [%  Mode correction
            enhanced jigsaw, colback=tcbcolback!50, segmentation empty
        ]%
        {%  Boîtes internes
            sidebyside, sidebyside gap=6pt,
            lefthand width=2em, sidebyside align=top seam,
            halign upper=center, halign lower=justify,
            boxsep=3pt,
            before upper={\tikz[baseline=(x.base), inner sep=0pt, outer sep=0pt]
                     {\node (x) {\vphantom{\'Ep}};
                      \fill[white] (-0.4em,-0.4em) rectangle (0.4em,0.4em);
                      \ifmcqbr{\node[red] at (0,0) {\ding{56}};}{}
                      }}%
                     \tcblower\vphantom{\'Ep}%
        }

\newMessageFormat{Troyes}%
    {%  gauche
    boxsep=5pt, colback=TroyesColback!20, left=1em,
    overlay={
        \fill[TroyesColback] (interior.north west) rectangle ([xshift=1em]interior.south west)
            node[midway, rotate=90, text=white, font=\sffamily\tiny\bfseries] {Info} ;
        }%
    }
    [%  droite
    boxsep=5pt, colback=TroyesColback!20
    ]

\newHeaderFormat{Troyes}%
    {%  Left header
    blankest,
    boxsep=5pt,
    halign=center, valign=center, fontupper=\sffamily\bfseries\footnotesize,
    coltext=TroyesColback
    }%
    [%   Right header
    enhanced jigsaw, arc=3mm, sharp corners, auto outer arc,
    boxsep=5pt, colback=TroyesColback,
    halign=center, valign=center, fontupper=\sffamily\bfseries\footnotesize,
    coltext=white
    ]

\newFooterFormat{Troyes}%
    {%  Left footer
    enhanced jigsaw,
    boxsep=5pt, %colback=TroyesColback,
    interior style={top color=TroyesColback!60,bottom color=TroyesColback},
    sharp corners, arc=3mm, rounded corners=south, auto outer arc,% l'ordre est important
    halign=center, valign=center, fontupper=\sffamily\bfseries\footnotesize,
    coltext=white
    }


\newMcqFormat[gather=Troyes, every odd row={colback=tcbcolback!60}, column sep=1.5pt, row sep=1.5pt]{Troyes}{0pt}