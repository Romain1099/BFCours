%%%%    Tokyo

\definecolor{TokyoColback}{HTML}{4A85A1}% bleu


\newQuestionFormat{Tokyo}{% boîte externe
opacityback=1,
colback=TokyoColback!60,
        interior code={%
            \fill[tcbcolback] (interior.north west) rectangle ([xshift=-0.75pt]segmentation.south);
            \fill[tcbcolback] ([xshift=0.75pt]segmentation.south) rectangle (interior.north east);
            }%
}%
{%    boîte interne
sidebyside, boxsep=3pt,
sidebyside gap=7.5pt,%  3+1.5+3
lefthand width=1.2em,
sidebyside align=top seam, halign upper=center, halign lower=justify,
before upper={\tikz[baseline=(x.base), inner sep=1pt, outer sep=0pt] \node[circle, fill=white, text=TokyoColback, font=\sffamily\bfseries\tiny, minimum width=1.2em] (x) {\rdmcqQuestioncount};
\tcblower}
}

\newAnswerFormat{Tokyo}{horizontal}%
        {%  Zone Réponse
        }%
        [%  Mode correction
            colback=red, opacityback=0.15, /tcbchkbox/checked corr
        ]%
        {%  Boîtes internes
        /tcbchkbox/.cd, tcbcheckbox@defaultstyle, checkbox auto color, boxrule=0pt, colback=TokyoColback!60, opacityback=1, halign=flush center
        }

\newAnswerFormat{Tokyo}{vertical}
        {%  Zone Réponse
            enhanced jigsaw,
            frame engine=empty,
            colback=TokyoColback!60
        }%
        [%  Mode correction
            enhanced jigsaw, colback=tcbcolback!50, segmentation empty
        ]%
        {%  Boîtes internes
            sidebyside, sidebyside gap=6pt,
            lefthand width=2em, sidebyside align=top seam,
            halign upper=center, halign lower=justify,
            boxsep=3pt,
            before upper={\tikz[baseline=(x.base), inner sep=0pt, outer sep=0pt]
                     {\node (x) {\vphantom{\'Ep}};
                      \fill[white] (-0.4em,-0.4em) rectangle (0.4em,0.4em);
                      \ifmcqbr{\node[red] at (0,0) {\ding{56}};}{}
                      }}%
                     \tcblower\vphantom{\'Ep}%
        }

\newMessageFormat{Tokyo}%
    {%  gauche
    boxsep=5pt, colback=TokyoColback!20, left=1em,
    overlay={
        \fill[TokyoColback] (interior.north west) rectangle ([xshift=1em]interior.south west)
            node[midway, rotate=90, text=white, font=\sffamily\tiny\bfseries] {Info} ;
        }%
    }
    [%  droite
    boxsep=5pt, colback=TokyoColback!20
    ]

\newHeaderFormat{Tokyo}%
    {%  Left header
    blankest,
    boxsep=5pt,
    halign=center, valign=center, fontupper=\itshape\footnotesize,
    %coltext=TokyoColback
    }%
    [%   Right header
    enhanced jigsaw, arc=3mm, sharp corners, auto outer arc,
    boxsep=5pt, colback=TokyoColback,
    halign=center, valign=center, fontupper=\sffamily\bfseries\footnotesize,
    coltext=white
    ]

\newFooterFormat{Tokyo}%
    {%  Left footer
    enhanced jigsaw,
    boxsep=5pt, %colback=TokyoColback,
    interior style={top color=TokyoColback!60,bottom color=TokyoColback},
    sharp corners, arc=3mm, rounded corners=south, auto outer arc,% l'ordre est important
    halign=center, valign=center, fontupper=\sffamily\bfseries\footnotesize,
    coltext=white
    }


\newMcqFormat[gather=Tokyo, every odd row={colback=tcbcolback!60}, column sep=1.5pt, row sep=1.5pt]{Tokyo}{0pt}